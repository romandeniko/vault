---
created: 2025-10-02T18:04:00
status:
links:
  - "[[Базы данных]]"
  - "[[SQL]]"
  - "[[Запросы SQL]]"
---
```sql
SELECT title, name_author, name_genre, price, amount
FROM
    author
    INNER JOIN book ON author.author_id = book.author_id
    INNER JOIN genre ON book.genre_id = genre.genre_id
GROUP BY title, name_author, genre.genre_id, name_genre, price, amount
HAVING genre.genre_id IN (
    SELECT genre_query.genre_id
    FROM (
        SELECT genre_id, SUM(amount) AS Количество
        FROM book
        GROUP BY genre_id
    )genre_query
    INNER JOIN (
        SELECT genre_id, SUM(amount) AS Количество
        FROM book
        GROUP BY genre_id
        LIMIT 1
    )max_genre
    ON genre_query.Количество = max_genre.Количество
    )
ORDER BY title ASC;
```

- Обратите внимание, что в группировку включен столбец `genre_id`, который используется в `HAVING.` Это связано с тем, что в `HAVING` можно использовать либо столбцы, перечисленные в `GROUP BY`, либо вычисляемые с помощью групповых функций столбцы. Добавление столбца `genre_id`не влияет на группировку, так как между названием жанра и его ``id`` - взаимно-однозначное соответствие.
- Название столбца `genre_id` задается с указанием имени таблицы (`genre.genre_id`), так как этот столбец входит в структуру двух таблиц `book` и `genre`.  Для этого запроса можно было бы указать и `book.genre_id`, так как эти таблицы связаны внутренним соединением `INNER JOIN` и имеют одинаковые значения в полях `genre.genre_id` и `book.genre_id`.






























