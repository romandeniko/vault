---
created: 2025-10-09T15:47:00
status:
links:
  - "[[Базы данных]]"
  - "[[SQL]]"
  - "[[Запросы SQL]]"
---
```sql
SELECT buy.buy_id, title, price, buy_book.amount
FROM
    client INNER JOIN buy ON client.client_id = buy.client_id
    INNER JOIN buy_book ON buy.buy_id = buy_book.buy_id
    INNER JOIN book ON buy_book.book_id = book.book_id
WHERE client.name_client = 'Баранов Павел'
ORDER BY buy_id ASC, title ASC;
```

```sql
SELECT name_author, title, COUNT(buy_book.buy_id) AS Количество
FROM author
     RIGHT JOIN book ON author.author_id = book.author_id
     LEFT JOIN buy_book ON book.book_id = buy_book.book_id
GROUP BY name_author, title
ORDER BY name_author ASC, title ASC;
```

```sql
SELECT name_city, COUNT(buy.client_id) AS Количество
FROM city
     INNER JOIN client ON city.city_id = client.city_id
     INNER JOIN buy ON client.client_id = buy.client_id
GROUP BY name_city
ORDER by Количество DESC, name_city ASC;
```

```sql
SELECT buy.buy_id, name_client, SUM(buy_book.amount * book.price) AS Стоимость
FROM book
     INNER JOIN buy_book ON book.book_id = buy_book.book_id
     INNER JOIN buy ON buy_book.buy_id = buy.buy_id
     INNER JOIN client ON buy.client_id = client.client_id
GROUP BY buy.buy_id
ORDER BY buy.buy_id ASC;
```

```sql
SELECT buy_step.buy_id, name_step
FROM buy_step 
     INNER JOIN step ON buy_step.step_id = step.step_id
WHERE date_step_beg IS NOT NULL AND date_step_end IS NULL
ORDER BY buy_step.buy_id ASC;
```

























